<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>AUTO KETTLE</title>
        <link rel="icon" type="image/x-icon" href="/webapp/imgs/favicon.ico">
    </head>

    <body>
        <div align=center><h1>AUTO KETTLE</h1>

            <form action="/data" method = "POST">
                <p>GPIO pin to use <input type="text" name="GPIO_pin", placeholder="1-40" required=True/></p>
                <p>Water temperature<br>30°C<input type="range" min="30" max="100" value="80" name="kettle_temp" id="kettle_temp">100°C</p>
                <p>Store data in a file for later use<input type="checkbox" name="filesave_toggle" checked></p>
                <h5>Warning : Userdata will be removed if you submit the form without checking the box</h6>
                <p><input type="submit" value="Submit"/></p>
            </form>

            <form action="/heat" method="GET">
                <p><button name="heat_button" type="submit">Heat up the kettle</button></p>
            </form>
            
        </div>
        
        <div id="graph"></div>

        <script>
            const log = (text) => {
              document.getElementById('graph').innerHTML += `${text} <br />`;
            };
      
            const socket = new WebSocket('ws://' + location.host + '/graph');
            socket.addEventListener('message', ev => {
              log(ev.data);
            });
            document.getElementById('form').onsubmit = ev => {
              ev.preventDefault();
              const textField = document.getElementById('text');
              log('>>> ' + textField.value, 'red');
              socket.send(textField.value);
              textField.value = '';
            };
          </script>
    </body>

</html>